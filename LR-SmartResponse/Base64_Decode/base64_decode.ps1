param(
  [Parameter(Mandatory=$false)]
  [string]$action = 'decode',
  [Parameter(Mandatory=$false)]
  [string]$value = "NWUgMjYgOGEgYTcgNmMgOTMgNWIgNDQgNTMgNWIgMDQgNWUgNzEgZWIgZDcgMzggDQpjMCBhMSBl
NCA1ZSBjNyBmMCAzNCBkZSBiMiAxYiAwZCAxMiBiYyBkOCAwNSA4NCANCjU2IGI2IGUyIDU5IGQ1
IDMzIGIzIGQ0IDhiIGUyIDIzIGFiIGM5IGVkIDU0IGE3IA0KOTUgNzYgNjAgNTQgN2IgY2UgMTgg
MWEgMGEgMGUgMjggZDggYWYgM2EgMDAgZTcgDQozNCA0ZCAxYiAwYSBjNiBjOSBiYyA0NSA3NCA5
NSBkZSBkOCAyOCBlYyBlNiBkYiANCjcyIGUwIDk0IDdjIGI0IDI0IDI2IGEyIDM3IDQxIGRlIDZh
IGEyIGVmIDM5IGE2IA0KNmIgY2QgNjkgYjQgZDMgOGYgZGIgN2MgYzggNzEgZGQgYTcgYTEgNjIg
M2IgNGEgDQo4YiAxYSA5ZSAzMyA3NiA5MiAxMSA0MSA0OSA1MiA2MCBkYSAwZSA4MyBhNiBlNCAN
CjAyIDljIDhmIGZjIDZiIDgwIDBmIDgyIGRhIDQ2IDE2IDBhIDIzIDFlIDMxIGEzIA0KZDcgZmIg
NjIgNzAgNjIgMmEgOTAgM2EgNmYgY2EgYzEgYjIgNTEgMzAgYWQgZmUgDQpmMiA4MSAyMSA5YiA4
MyBjMiBmOCA1NCAzYyBkZiAzNiAxNSBiNSA4YyBlNiBhMyANCjE2IDc4IDVkIDJmIDU1IGEwIDdh
IGRmIDhiIDdkIGMxIDVjIDZmIGEyIDg1IDQ4IA0KMzQgMTkgNGIgYzEgYzAgMjMgZTkgNDAgMTAg
NGMgZmIgYzQgZmEgZDMgNTIgYzMgDQpjMCBiMyBkMCBmMCAzYSA0NiA5NyA3YyAyNyAxNCBlNSA3
NSAzNiAyYyA2OCBlNCANCjU4IDliIDMzIGRiIGU3IDFkIGVlIDY0IDY3IDc2IGYwIDgzIGRlIGY2
IDY3IDM4IA0KMmEgNzcgNWEgZmIgODcgNDcgNjUgYjggZWEgMDYgZGQgODEgZjcgNGUgNWMgZjYg
DQo4MCBiMSA3ZiAwNiBhOSBkNyAwOCAxNyA0ZSAwZSA2NCBlYiBhNCA2NSA2OSBmYSANCmRjIGE3
IDYzIDNkIDdmIDNlIGIwIGI5IDBjIDBjIGQyIDY2IDMzIDc0IDkwIGE4IA0KYTEgOWMgNGEgNDUg
MjEgODkgMWYgNjkgMmYgZGUgYjggN2YgYmUgYTEgNjMgZGMgDQpkMyAzNSBlNSAzZCA1ZSAzMyA0
ZSAyMiA1MyA4NCAxMSBlNSA4NSA3OSA5ZCBmOCANCjUwIDZlIGZhIDAwIGExIGZmIDg5IGMyIGM4
IGM0IDUxIGExIGRiIGUyIDhlIDNlIA0KNGEgYmIgM2EgOGUgZDMgMGQgNTUgOTAgYjggNDkgYzYg
YmEgMTggMmMgYjEgMGIgDQpjMCAwYSAyNiBlNyA1NSA5YiAzNyBmMiBkZCA3MiA5ZSAyMSA1YiA3
MyBkYiA5MyANCjYyIDc2IGE5IDFiIGQ4IGI4IGQ4IGM5IDE0IGI5IDA5IGZlIDgyIGI5IDIzIDUx
IA0KOTIgODUgNjcgODkgNjUgZGYgMDEgNTcgOTYgNDkgN2EgMjcgMTcgODYgMmUgMDcgDQo0YyA0
ZSA1MiBkMiA4OCAwNiBmOCA2YyBlYiAxZiA1NyA0YyBhZCA0YSAyZSA0NiANCjgxIDUyIDFmIDg0
IDY1IDk4IGUxIGM2IDU1IDgxIGRiIDUxIGRlIGU1IGNhIDYwIA0KZDYgYWUgZTMgZmUgODcgMWMg
MDYgMzkgZjUgOWIgOGMgMWQgMGQgZTQgNjkgODggDQowMyBlNyBjYSA5ZiA5ZCA3MyBjOSBmOCAw
MCA2NiA3MiA1NSA4YiBlZiBmNCA3YiANCjYwIGUzIGI1IDIyIDFlIDFhIDkyIDFkIGMyIGRkIGQx
IGE1IDczIGM2IDNlIDg1IA0KNWYgYTIgYzIgMmUgYzkgZDQgN2MgM2YgNjcgZmQgNGMgMzUgMzMg
NTMgNjQgMDIgDQowYiA1MSAxMSA3OSA3NCAyNiA3YyAxNiA4NCA4NiAyNiBkYSA5NCA5NyA3NCA2
YyANCjZkIDFiIDRiIGQ1IDdmIDFiIDY3IGE2IGYxIDQwIDYxIGI4IDA4IGQ2IDc1IGE4IA0KMDUg
MzYgYmYgODMgMjQgMjQgMTMgNmMgZTAgNTIgNGIgNjQgMjAgNDUgZTMgMzAgDQo0NiA0NiA3OSBm
OSA0ZiAwNSBkMyAyMyAyNCAyOCBhNCA0NyAxMyA2MSA0ZSA0YiANCjZjIDI5IDQyIGI4IGI5IGMw
IGUyIDYxIDY4IDA3IGViIDI0IGE2IGJjIDA4IDExIA0KNzggYmUgMDIgMjYgYmEgYTUgN2QgMGMg
ZTkgN2YgYzMgN2IgYzEgZjUgMjUgZWQgDQo1ZCAzMiA3YiBhOSBiOCA3NCA2YyA0MSA1NSA0NCAw
MiBhMyAzYiA3YyA1ZSBhMiANCjIyIGM3IGM4IDhmIGM1IDMzIDNhIDUzIGE0IDJkIDg4IGJmIGM3
IDNlIDYwIDM4IA0KMTMgODkgZDEgNzkgOTkgMGQgNjcgNWUgMDQgYTEgN2EgZjcgOWYgODQgYTMg
NzcgDQo2YSA0ZSA1MyAxZSBmNCA2ZSAwYiA0NSAwYSA0ZSA2ZSA5ZiAzZSAwYyAzMCAxZSANCjVh
IGFhIDMwIDBiIDMzIDMxIDJkIDY2IDgzIDU0IGNmIDg3IGNkIDBjIGRmIDZkIA0KZjQgNDQgNmQg
ZTEgZmYgMmQgOGQgNTQgMTIgNWEgYjkgNzAgZDYgOGIgMTQgNDIgDQowZSA4NSAzNSA2OCA1NSA2
YyA4NiA1MiAwMSAxNCAwZCBjYSAzNiAxYSA0MSBjMSANCjgwIDk1IGZkIGQyIGZmIGYxIGMyIDc5
IGU2IGNiIGNhIGE2IGVhIDUxIDU4IGRmIA0KNjIgMDUgY2UgYjYgMjMgZjQgNDcgNDMgZDIgNTYg
YzUgMTggMjcgY2QgNzAgMmMgDQo2YSBiMiAxNSBjYyAzNyAzMSA2MiBlNSAyMiA1ZCBkYSA3MiAz
OSA5NSBlOCBkZiANCjhmIGRlIDEyIDBkIDk5IDk1IGQyIGM3IGQxIDYwIGI2IDgwIGI4IDZlIGZl
IDE2IA0KNTYgMzggZTMgZDggNzEgNzQgNzEgNTYgMmMgYTcgOTQgZDcgZmIgM2IgMGUgMmQgDQox
OSAwOCA0YyA3YyAxOCAzMCA3NCBjMCA4MiAzNyBkNCA0NiA5NiAyMyBmOCA4MSANCjc4IDZhIGIy
IGY5IDNlIDkwIGQ5IGJiIDYwIDBkIDI0IGEyIDU4IGNjIDFlIGU1IA0KOWQgOGUgZTYgNmIgYWUg
YmUgNTcgNDYgMmMgNTUgMTkgNmEgZjcgNzUgNDUgZDkgDQpiMiAxYSAwZiA3NCAwMyAzMCBmNSA3
NyA1MSBiNSAxZiBjMiBiOCBmNiBmYyA2NyANCmJkIDM3IDNiIDNhIDA0IGZjIGNkIGRmIDJkIDRh
IDg4IGE0IDQ4IDExIDhkIGY1IA0KOWQgNDQgNDEgOTggNWIgY2QgNGYgYjMgODggZTYgNWQgMDcg
ZmEgOGUgZmEgYzkgDQpiMiBkZCBlNiA1NSA0YSA4OCBlNiBlZiA5OSA4NSA1MiBlYSAyNiA5MyBh
MSBiMiANCmRmIDZhIDE3IDI3IGMyIGVhIDRiIDVkIDcwIGUwIDZiIDNkIDE2IGQyIDFlIGU2IA0K
YzQgOTkgYmMgNGYgZGMgNmUgYmQgOTUgZTkgMDcgMmMgNzggMWYgYzkgYjkgODIgDQo2ZiA0OCA0
NSAzOCAxYiBlNCA4MyAxOSA3YSA1OSA5NiAyMSA3MSBhOCBiYyA3MSANCjkxIDBkIDI2IDZkIGFh
IDkzIDQ4IDlkIDA4IGMxIGU1IDNjIDkzIDQyIDg0IDczIA0KMjYgYmQgMzIgZTkgYzcgNjEgZGQg
ZGQgY2EgMjYgOTggMGUgNWMgZmMgZjUgYWQgDQpkZiAwYiA2NiA4YSA0MCA2NSBlZCA2ZSA5MyA3
NCBlNyAwNiBiMCA2MyAzMiBhZiANCjkyIDFmIDU3IDMxIDdjIDg1IDYwIDFkIGNmIDU1IDYxIGY3
IGFkIGQ1IDI3IGQ5IA0KYTUgOGQgYWMgNjQgNTcgOWYgNWYgYjIgMjMgYTMgNTIgMWYgZjggM2Qg
NWMgNGUgDQozZSAzYyA5MyBmYiBlMCAyZSA2ZCBkNyAzZiBjOSA4NiA4MyBjZCAyYSA2ZiAyOSAN
CjVkIDdkIDA5IGQxIDk3IDcwIDJiIDk1IDJiIGI4IDc3IGNlIGM1IDg3IDU3IDkwIA0KYWQgNDUg
ZDYgNDMgNzMgOGUgZjYgMDQgMzYgNWEgMTkgZTYgODUgZjcgZDcgZWQgDQo0ZSBmYSAzMyAxYiBk
MCAyNyA5YSBiOSBkYiAwNSAxMiBkNCBmZiA2ZCA5MiBjMSANCmMxIDg1IDM2IDgyIGUyIGY1IDIx
IDA5IGY5IDVkIGViIDlmIDgwIDMyIDljIGJlIA0KOTIgM2YgMTUgZGMgMmYgMDYgNDggYWIgYjEg
N2UgMDcgYzcgMTMgYmEgNDMgMmUgDQoyZCA2ZSA5MiA1NyA0MCAwNyA0ZiA3YiAwMyA2MyBkMiBk
ZSA4YiA1MSBlZCBkYSANCjM0IDZjIDFlIDhkIGUyIDIzIGJhIGJhIDZiIDZjIDcyIGIxIDk0IDZl
IDI4IDE5IA0KZGYgYjggN2EgNzggOGMgZWUgZTcgYWMgNTcgZTggYjAgYzUgNTkgZjUgYzQgMGQg
DQo1NyA3ZSBjZiA1YyBjOSBiZiAxOCA2OCAyNiBlZCBkZSBiMiBmYSA5NSBjMiBiZiANCjE0IDdl
IDVjIGUzIDVjIDIzIGRjIGY2IDc2IDUwIGQ1IDE1IDRlIDdhIDVkIDVlIA0KZjAgNjggNmUgZWEg
ZDAgMzQgMDYgOTUgZDQgZWUgNzEgMTYgMzMgMjUgM2YgYmQgDQpmZCAzYyA3NiBiMSBkMyA5OCA1
ZCA4NiA5YyAzNCBhMSBkOSA4ZCBhOSBiMSBlOSANCjkwIGI0IDhkIGE2IDY4IDIzIGE4IDJkIDMx
IDk2IGRlIDhjIGI4IDBhIDk5IGFhIA0KOGUgYTcgZWEgZjQgNTcgN2MgMWMgNzYgZDAgNjcgODYg
NzQgYmQgYWEgNjEgMDUgDQpkNCBhMSBkMiA0MSBlMiA5NiBmNyA3NSBmNCA0ZCA4YiAyZiBkYyBl
MyBhYSAxZSANCjA1IDcwIDE4IDk3IGVjIDlhIDk3IDFjIDE5IGM3IGFhIGRkIDgzIDUxIGNkIDUz
IA0KYzcgYTQgYWQgOGMgNDcgYTQgYTMgNDAgNjMgZWYgOGYgZDEgM2IgNTggYWMgN2EgDQpiYiBi
MSAxYSA2NCBiYyAyMSAxNiBkNiAxNiBjYiA3NCBjYSA5MSBmZCBiZCBhNiANCjZjIDEwIDFmIDhh
IGE2IDYzIDc0IDEwIGRjIDdjIDg5IGYyIGYwIDkxIDJiIDliIA0KZjMgNDcgNjUgZWEgMDUgMWQg
YWYgZDcgYmUgMDUgYzAgZmYgMGEgNjYgZDcgODcgDQoyYyBmOSAwMSA0MyA4NSAzNCAwMCA4OCA0
NSA3MCBiZSA4OCBjMiA0OCAyMSBmMyANCmMxIDZkIDRkIGE0IGMyIGFhIDk5IDM3IDI4IDhkIDFl
IDgyIDE1IGQzIDUyIDM0IA0KZjUgYjIgMmUgNmQgZDEgNGMgOTMgYTggMWYgMGYgYzMgMjYgYjkg
NTggMjkgYTEgDQo1NSBlYSBlOSAyYiAzZiBkYiA3MyBlZCA2MCA3ZiBhNCBhZiA4OCAwMSAwOSBi
YSANCjdkIDEwIGE4IDcxIDU5IGU0IGQxIGE0IDVjIDFlIGFlIDE2IGI4IDg5IGE2IDAwIA0KMjEg
NzQgNmIgOTUgODcgYjIgZjYgNWQgMDYgNDEgMzIgM2UgNTQgZGMgNzUgMTUgDQo1MiA4YyBmOSA5
OCA1YiAyOSA3ZSA0ZCBkMSA3MiBlZSA3ZCA4NCBiNiBmMiBkZSANCjA2IDM1IDJhIGZhIGQ1IGJi
IDAyIDA3IDI2IDQ5IDZjIGNiIDc3IGM4IGU5IDc0IA0KZTAgNDIgMzQgYWIgNDMgMTAgNzIgZmMg
YjAgMTIgNTYgZGIgNjEgMjkgMDQgMDIgDQo0YyA0MSAyZCBhNiBmZiAzNSBlZiA2OCBiOCAxZCBi
YiBjMyAzNyA4MCAzNCA4MSANCmRjIDI5IDRmIDE0IGViIDE4IGMzIDAyIDg2IDEyIDM5IGIwIDU4
IGQxIGY2IDMzIA0KYTQgNzggOGEgZTcgN2MgMjUgYTggMTcgMWUgYjYgZDMgNzAgN2MgZGIgNGEg
YmIgDQo3YiA1YSBiZSBlOCA4ZCBkYSBiYSBkZCAzOSBkMSBmMyAxYSAwOSA2MSA2MyA0MyANCjk1
IGViIDMzIGJhIGE2IDBlIDM0IGEwIDMyIDU5IDQ1IGUwIGQzIDAzIDU0IDc4IA0KZjggZTcgYmEg
MjEgYzAgZGUgNWQgYmUgMzggZjMgNWMgYjAgMzQgMGEgYTggOGIgDQplMSBkZCA2ZiBiNCA2ZSA3
YiA2NiBhNSA0MSAwMiAyYiA0OCA5MiBjOSA2NSBhYyANCjYyIDA2IGU3IGYzIGVmIDAyIDRlIDhm
IGNhIDIzIGY4IGI5IGM1IDRiIDRhIDJjIA0KOTkgZDAgNmMgZDYgNGYgODggMzQgYTcgMjggNjAg
NDQgYzggZGEgMmUgMmUgYzkgDQphMSBjNSA0NyBmMyBmOSA3OSBiMyAwMSBiNSBhNyBmZSA2NCA0
MiA1NSAyZSAzNyANCmExIGNmIDAxIDM1IDZmIDNiIGRkIGMyIGIyIGUyIDIwIDBiIGVkIGFhIGJm
IGZkIA0KYjQgOTMgZDYgNGMgNTUgOWQgNDUgZWQgYzIgZWEgZTAgMGIgODAgOTUgOWUgZDkgDQo3
YyAxOCBmYiA0NSA3NCA0ZCBiNSBlZSA3ZSBlMiBmNCBiMyA3NyA2NCA1OCAwNCANCjU3IGMxIDI5
IDBhIDRiIDVlIDVhIGQxIDNjIGJkIDVkIGRhIGRkIDc3IDA0IDgwIA0KYjkgZWEgMmMgM2MgZWUg
NmUgNmQgZDMgNzAgMDkgNDEgYjcgMTEgMDEgYTQgZWQgDQoxZSAzOSBkNSAwMSAwYyAwZiA0MCAx
NiA2OSBlOSAwOSAxNyBjMSA0ZSA0NCAzYyANCjIzIGZkIGIzIGEzIDcwIDFhIDE4IDc4IDNkIDI5
IGVlIDZiIDcwIDhlIGM2IDg2IA0KYWMgNWUgMTggNWUgNmEgZjUgZjMgZGEgYmIgY2QgY2MgNTQg
MjcgYTAgZDIgZDggDQozNSA4NyAzYyBiOCBlMyAxYyA4NiAzNiA2ZSBhZSA5ZiBlMSA1NyBjNCAw
OSBhZCANCjNlIDQ0IGMxIGYzIGNkIDQ1IGVlIGJhIDU2IDY4IDBlIGI0IGMyIGJiIDZiIDcxIA0K
MDUgOTAgZDEgNTIgMzUgZDIgNTYgNzYgN2MgNDcgNTYgNWMgMDIgYWUgMjEgMzAgDQo1ZiBkMyBj
NyA1NCBlYSBmZiA5MyAyZiA0OCA1YiAzZiA0MiBmMiAyNyBkZCBiNyANCjdhIDA5IDhjIGMzIGE3
IGJmIDk2IDM2IGU1IDdiIDdjIDFiIDIwIGZmIDU0IGM3IA0KNjIgYjcgMGIgNGQgOGIgMWIgZGEg
ZDMgYWMgM2MgNWEgYTYgN2IgNjcgNTAgODAgDQo4OSAxNiAxNCA1YiA1ZSAyNyA4MSBhMCA1MSAx
MiBjOCA4YSAyZSBjYyA1NiA5YSANCjgxIDI0IGFlIDg1IGMzIDA0IGM5IGNlIDMwIDA2IGI0IGMw
IGJkIGFhIDAyIDBhIA0KM2MgYjEgY2QgOTEgMzEgY2IgYmIgNWYgY2QgMmUgYjcgOWUgZjUgYmUg
NDcgMWUgDQo0MCBhMSA0YiBlYSA3YSA1MCBkOCAzYyBjYyAwNCBhZiA1NCA3ZCA4NSA1MCBhOCAN
CjI2IDcwIDE3IGE5IDI0IGE3IGMyIDYyIDE3IDE0IDk2IGFhIDFhIGU3IGRkIDZlIA0KNmIgNTYg
Y2QgYWQgYzcgN2YgZjcgODIgZmIgZjQgN2QgNzIgYmIgOTkgYjYgYTEgDQphYyBjMCAwMiA5NiA4
MSA4YiAzZiAwNiA2NSAwNyAxOSA4NSBmMyA4ZiBhZiA5NyANCjZhIDlmIDRjIDgyIGZhIGM5IDJh
IGE5IDBmIDNhIDJiIDFlIGQ2IGRlIDg0IGQ2IA0KOTkgMmMgMmYgYzUgOWIgZWUgZmYgNWEgYTUg
MjIgNmMgZjIgNmYgNWUgYWUgMjQgDQpiMiAwOCBiNyAyOSBiYyAyZCA0YSBkNCBiMSAwMyAxMSA2
NiBiYiBiNiA2YSBkYyANCjIxIDI1IDU4IDAzIDRlIDY2IDNmIDBhIDBlIGI0IDBhIDMxIGJkIDMx
IDgyIDQ4IA0KOTQgNjcgNDkgYzkgYjMgNjcgNzMgODEgM2QgYzIgNzAgOGMgY2IgOWEgZDcgNjEg
DQpkMyA4ZCA1NiBjMiBjMSA2MiBiMiBjZiAwYSAzNiAxZSAxNSBkMiAwNCA2MCBlNiANCmZiIDIy
IDZlIDQxIGNhIDAyIGUyIDMwIDc0IDNiIGJlIDE5IDMwIDBiIDdhIGJmIA0KMDkgMGYgNTQgMWEg
NmQgYzggOTggNjAgMmEgNjggNDkgYWUgMmIgNDYgNDEgYmMgDQowMyA4ZiBlOSBhNSA2ZCBjNiAz
NCBlOCBkMSA2NyBiZCAzZiBjYSA5MCBlMyA2MyANCjA4IDk1IDA5IDJiIGU1IDdjIDM2IDZiIDhk
IGQ0IDYxIGEyIDEwIGY4IDRlIDE2IA0KYTAgNTcgZGYgMDUgNjUgMjIgNzggYWUgMzcgMjQgZTUg
YzAgZDkgYzEgOTAgZWEgDQowNyA1YiA5YSAxYiA3MCA0YyBjNiA0MSAwZCBlYSA2MiAwMCA1MSBk
MCAwNyAxYyANCmJmIGU3IGZjIGNkIDg3IGY5IDczIGI4IDU5IDcxIDA4IDczIDdjIDYyIDFkIDll
IA0KNDEgNjkgOTYgMzcgN2QgNGYgNmYgZDcgNTYgOGIgMGYgNzAgZDMgNjggOTUgOWYgDQphZSAy
MyBkOSBiOCA3OCA2ZCAyNSA0ZCBkYyAwZCA1NSA2MSA0MSA5MyBjYyA1OCANCjI4IDllIGVkIDU3
IDZlIGJjIDJhIGU0IGVmIDQwIDRlIDBhIGU4IGVlIDBhIDhkIA0KNGYgNmQgZjkgOGEgNWUgMWYg
NWYgZTMgMTkgYzQgMWIgY2IgMTkgNzYgMzAgYjggDQo3NyA5MyBiZiA2MyAxOSA0MiBlMCBlZiAy
NyA0MSAxYSBhOSBiMiBiZSBiNiA5ZSANCjg2IDZhIGExIGFmIDczIGI5IGNkIDQwIDJhIDFlIDlm
IDA2IDIyIDlkIDg1IDBkIA0KMzEgYmEgOGUgNWEgNWUgOTEgNTEgYzggNTEgNTIgZTkgMzcgZmEg
MDMgMmMgMjEgDQo1NCA1ZCBkOCA0ZSBhMyA3YiBhOSAzOSBhZCA2YiAwMyAxMCA4NSBmOCA0OCBk
ZCANCjE1IDVmIDI4IDYwIDcxIDE0IDFiIDRiIDIyIDBmIDFiIDdkIGYxIDI3IGY0IDY2IA0KN2Mg
ZTUgNDEgZGYgYzYgMDUgYWEgMmUgNjUgODEgYTAgMTkgZDcgYWQgMzYgMzcgDQozNSBjNSAyMiBi
ZiAzNSA4YSBkMCBjMiAyNSA0ZSA5ZiA1MyA1YSA1MSA0MyA4OCANCjZiIGJmIDJhIDkyIDE3IDk5
IDU0IDZlIDNjIGIyIDJhIDdhIGExIDU5IGJkIDA1IA0KNDUgZmQgYzEgZDEgOWYgZTQgYWQgMDMg
ZTAgNDEgZGMgYjYgOTggZGYgZmQgNTQgDQo5OCBiNCA2OSAyZiA2NyBjZSAzZCAwMCA0OSAyOSAx
ZCBkMyBhZiBkMiA5MSBhOCANCmU1IDBhIDI0IDNlIGNhIDgzIDI1IGJmIDc0IDY5IDY4IGUzIDE1
IDA4IDUwIDJjIA0KZmYgMDcgMzcgMzcgOTUgOGYgZGIgNDMgNzIgMTggOGYgY2QgMWUgNmIgY2Qg
MzYgDQpjZiBhNiBhNSA2ZSAzNiBiNCBmMiBhMSA0YyA5MSA2NiAwOCAxNiA1MyBkOSAwYiANCjBh
IGQyIGU4IDYyIDAwIGEzIGFiIGVjIGZkIGVjIDYwIDVmIGQ0IDQ2IDVmIGEzIA0KYzAgZDIgMWUg
MTYgYzkgYTcgYjcgM2IgODYgOGUgZWMgMzggNjEgZTYgYmYgYWEgDQowNyA4MiAzOCA0YSA3YSA2
NiBjMCAxYyA3OCBlYSA3MCA2OSAyNCBiZSBmNCBiMCANCjAyIGY5IGNmIDE4IDU4IGQ0IGFlIGVl
IDBhIGUyIGFjIDVmIDY1IDFiIDgwIGNiIA0KYjUgMzQgMDAgYjcgMzIgYzEgMzAgMjEgYWIgNTAg
ODEgYTcgYTEgMjYgZmEgMmYgDQpjNSBiYyBhMSBhOCA0ZCA5NyA2OSAwYyA2OSA1OSBkMiBiNCBm
ZiBjNyA4OCBjZiANCjZmIDA2IDJiIDViIGMxIGFjIDIwIDAzIDhjIDdlIDk5IDU2IDY2IGVkIGVh
IDg0IA0KYTAgNDYgMWQgMDYgMTAgNmYgN2QgNWEgODggMWIgOGQgNTkgMDcgMDIgOWEgMjQgDQpi
OCAwMyAzMSAyMyBjMCAzZiA0MSA1MCAyZiA4YyBlYiBjZCA1NiA3MSBkMCBkNiANCmUwIDA4IDQw
IGYxIGEwIDZlIDI5IGVhIGMzIDU3IDFmIDU2IDA5IDJiIDQ2IGIxIA0KYjQgNmQgYjMgYTcgNTgg
ZWEgODEgYzAgNWIgMWIgMDYgNjAgMTIgMmYgZTQgNWEgDQoyMSA2YiA3MCBhNCBkMSA0YyA1ZSA4
MCA5NCA1YSBlNiA4NiA4ZiAxZCA3OSA2MiANCjk2IDA3IDkwIDRiIGJkIDljIDIwIGQyIGMwIGM4
IDExIDgwIGY1IGEwIDFiIDQzIA0KMzcgM2QgMmIgZTUgMzAgOWYgMWUgYWUgYzggMGEgMjAgNDUg
N2UgMzkgMTUgMDIgDQo5OCA0ZSAzNSBjYyAxMCA5NSA5MyBkNCA5MSA5OCA2YyBiMCBjNiAwZiA5
NCBkZCANCjFmIDUwIDcyIGE2IDZjIDMyIDUyIDYyIDkwIDA0IDI1IDNiIDAyIGFiIGIwIDBhIA0K
NTYgZDQgNWYgOGEgMzMgN2QgODYgOGQgNjggZTUgMzkgMmMgYjcgNjcgNmQgNmIgDQpmYyBiZCA5
YiAzMCAyMCA5YSA3MSAxOSBmOCA4MCA3YSBmNCAyNiA3OCA5MiAyYSANCmRkIDE3IDQ0IDQxIDZj
IGI4IGFlIGUyIGEzIDNjIDM4IDMwIDZjIGJjIDM5IGU5IA0KNjcgMzggMWEgNzkgZmUgYWMgODcg
YzMgOWYgOTYgNjUgZTAgODAgYjQgODIgNWUgDQozNCAyOCBjOSA5NCA1NiA3YiAyMiBhMSA1MyBk
OCA3NiA2OSA0NSA2OSBjYyAzZiANCjJkIDZiIDJmIGY5IGQ4IGEyIGNlIDE0IDI3IDgyIGE5IDY0
IGZjIDQ5IDM1IDdkIA0KYjggZTggNjAgZTAgN2UgMTEgMGIgN2IgMDcgNzQgZGIgZmQgMzEgZDMg
Y2UgZjggDQpjMSAzMyAxMSBhMCA0ZiA3ZiBhOSBmZCA1NiA1YiA3OCAxNSBhNyAwNCA0MSAzNiAN
CmNkIGNkIDEzIGE1IGI4IDA0IGZmIGFkIDk4IGFkIGJmIGQ2IDNhIDgxIDM3IGQ0IA0KOTQgMzIg
ZDEgMTkgNjEgMjEgMGYgY2YgZDAgYjUgNDQgNjggNTAgMjYgM2QgZmMgDQo1MSBmYSBjNiAwZSBl
YiAwMyA1MSA0OCAzNyBkOCA3MiA5ZiAyZCBlNCBjZCBkOSANCjMzIGU1IDVjIGJlIDgwIDI4IDY1
IDZlIDcyIDc2IDhlIGUxIDY1IDg2IGMzIDMxIA0KN2EgY2IgMGIgY2UgYWUgZTggMTQgMWQgOWQg
OWEgOGQgYjIgMTUgOTggNTggODkgDQozYyA2MyBkZiAzMyBhYyA4OCBlNSBlYyAyZiA3YyA5NCAz
ZCBkMyAyNCBmNSBjZiANCjljIDk0IDk5IGU5IDI4IGZiIDJmIDZhIGUwIDUxIDY4IGQ1IGY2IDdl
IDUwIGFlIA0KODggZWUgMmIgMzYgYzMgMzIgYjIgOTcgYzMgNWQgZTcgYzcgYzggZDIgNzEgZTgg
DQo5NyA4NyBmMiBmNiA0NCA1NyA0NyAzZiA2OCBlNiBlNyBlNCBiZCBkMyA3NiA4MSANCjJkIGZk
IDA3IDZjIGNmIDViIDM3IDBiIGFhIDBhIGYzIGIyIDA4IDRmIGNjIDc0IA0KMGIgNTAgZDAgMjMg
ZGUgZGMgY2UgNDEgMDcgODcgOTIgYzEgNjggNTEgNTAgNTQgDQoyMSA1MSA0ZiAxYSA4NCBjYiBi
MCA4MCBjMyAxNiAyOSAwMCA2NSBjMiA1NCA5ZCANCmVjIDM0IDA3IDNhIGQ3IDcwIDI4IDliIDA5
IDE2IDc5IDBkIDY5IDY2IGVhIGFhIA0KMGMgNTYgOGEgMDMgZWYgZDkgMjIgYzEgMmEgMjggMDQg
YzQgM2YgNDMgMjEgMTMgDQphOCBjYSBmMCBhMiBmYiAzNSAzZiA3OSA0OSBkNiBlOCBmZSA0OSBk
MCBmYSBhYSANCjg1IDc0IDIwIDg3IDVmIGRmIDE4IGI5IDNiIGI5IGIwIGJkIDYyIDFhIDJhIDll
IA0KNjQgYzYgYjMgODIgYTkgNDYgNTYgZjMgZjggNDAgOWQgODAgNzAgZjIgYzggZDIgDQpjMCA1
NCAyNSBiOSBjYSBmYiBiNyBjMCAzNCBjMSA1MiA1ZiAwMCA4NiA2ZCBlYyANCmI0IGQ3IDYyIGQ0
IGQ3IDhhIDY3IDc1IDQzIDMxIDUwIDFhIGYwIDY3IDVlIDUzIA0KMDUgYmEgM2MgMjMgMzMgMjkg
YmMgZTMgNTEgM2EgNDAgYjAgMmIgODkgZTggZjEgDQplMyBlZSAwMyA0YiBjZSA4MSA2NiAzYyAx
NyA1YyA4OSBiMCAxNiA0OCAzNyAwNiANCjk0IDdjIDZkIDMyIDBkIGYyIGRkIGUzIDdlIDAxIDYx
IGFkIDVkIDY5IDA1IDJhIA0KYmYgZGYgOGUgOGYgOGUgMTcgN2QgMmMgM2UgOWYgN2UgOTcgNTYg
OTcgNzUgODcgDQozNSBiZSBmNyBiYSBhOSBlMCAwMSA2MSA0NCBiOSA1OSBhMSA1YyBmNSBhNSA5
ZiANCjcxIDQ0IDM0IDQ4IDc3IDVkIDdhIDg0IDhkIDQ5IDQxIDllIDUzIGNjIDIwIDM1IA0KNWQg
ZDEgMmYgMTUgY2QgMDcgMDUgYzYgN2IgMmUgODMgOTggMTggMDUgMjUgNTAgDQpiNCBjZSA3NSA5
NyBkYSA3OCA4OSAwYiBlNSA4YiA2NiAzOCBhZSBjNiA5MSA2NCANCjQ0IDAxIGY2IGZjIDllIGVm
IDgxIDkxIDRkIGIzIDJiIGM4IGZmIDQ3IDAwIGNkIA0KNTkgMmYgNDIgZTQgOWQgYzYgN2QgNDIg
YjggZDIgYjEgZGYgYzYgN2UgOWEgM2QgDQo1YyAyYiA2MCAyOCBmNyAzYyBjZSAxZiAyNiBlMSBm
NyA3MyA2OSAxNyAxNSBiZCANCjg4IDNkIDU4IGFlIGE4IDA5IDJmIGY5IGM3IDA3IGUxIDc5IDZh
IGRhIDNlIDAyIA0KMjIgYzggYTAgMWYgZWIgNzEgZWMgZWMgYjUgOTYgMWUgYzEgM2QgODQgN2Yg
MDAgDQpkNCBhMSAyNSBlNiAwMSBmNSBhZSA2NSAzZiA1MCA2OCA1MyA1MCBiNyAzNiA5NSANCmEy
IDM1IGQ3IDRlIDUxIDk4IDcwIGYwIDIwIGY1IDcwIGEzIDI1IDdkIDkwIGMyIA0KZmIgZmYgY2Ig
NTIgNDggOGMgMTcgNzUgZmUgMjAgMjggNzEgZTEgOTkgYjkgMGUgDQphNyBiZiBlOCBmNCA0YyAw
NSBlNSAzMCA1YyBmYSAwZCAyMiAwYiAzMCBmNyAzMyANCjJkIGI2IGI0IGVkIDM5IGU2IDMwIDNl
IDYyIGVmIDIzIDc4IDZkIDEzIGI5IDJjIA0KMGYgYjkgNjUgNWIgYTggMTAgZGQgMGQgNGQgZmQg
NDcgOGIgMzggZjggYmIgMWEgDQoxNCA4NyAwMSBhYSA4ZSBjZSA2YyBkYyA1OCA2NiBjNSA2OCBh
MSAyZCA5YyA0YiANCjg4IGQ2IDcxIDNmIDEzIGJlIDVmIGIxIDI2IDg1IDlmIDQ4IDJkIDQ4IGQ0
IDlmIA0KNTQgZjAgZjQgODMgN2EgZjcgYzcgMGIgNWQgNTUgMDQgYzcgNDQgZWIgZDYgZWQgDQo0
YSA0ZiBlOSAzMyAyOCA5NiBiYSA4MyBjNyAzYyAzZCBmNyBhMiA5MiAyZCA3ZSANCjhkIGE4IGFi
IGU1IDk3IGY0IGVmIDM3IDEyIGY2IDY2IGQ2IGZkIGQyIDUyIGIwIA0KZWYgOTMgMjcgZWIgMmMg
OWUgNWYgYWEgZWYgOTkgMjggMWYgMTUgZjEgMWMgM2IgDQpkNiBjZSBjZCA4MiAyOCBmZiAzMiBi
MyBiYSAxZiA1MiAzNSA5OSBkYyBmNCBhNiANCjYzIGY4IGJhIDUxIDU1IDE0IGU3IDU3IGEzIDY0
IGZjIDU3IGExIGZiIGE3IDhiIA0KMTUgNzcgYTkgYzYgNGIgYjMgOTYgMmEgNjEgNzkgZmIgNTgg
ZDAgOGQgNzMgZTkgDQpmMSBjMCBhMCBkOSA0NSBjNyBmMiA2YiBmYSBlZiAzYyBkMyBlNCBmMCBh
YSBjOCANCmU4IDY4IDFmIDljIDg4IGFjIGYxIDVjIGM5IGRkIDUyIDZjIGJhIDhkIDBiIDhkIA0K
NzYgODkgMTAgZDYgNWEgNjkgYjMgMjQgNzUgODUgZWMgNGQgMDMgMzggYWMgN2UgDQo4MiA1MyA1
OSBkZiA3OCA3ZCAzNSAwYiA4YiAyNCA4MCBiYiBmNSA3MiA3MSAyYSANCmJiIGU4IGJlIDM4IDBm
IGFhIGJhIDYyIDBiIDg3IGZmIDI1IDhkIGE5IGQ4IDUxIA0KODcgMGIgZTIgZGEgOWYgNzggOTkg
ZmEgZWIgMDAgYzkgYmIgOTUgMDggYTIgNDkgDQoxOSA3OSA5NSBiYiBkZSAwZCBmYyBjMyA1YSBl
NiA5OSA5OCAyOSAwNyA4NSAyYyANCjk0IDc0IGE3IDgyIDdhIDg4IDY3IDEwIDY1IDRkIDg3IDg5
IDkzIDE1IDEyIGVjIA0KYzMgMTMgY2QgOWEgMzAgY2YgYTMgZGQgMGQgNDcgMDUgY2QgMzkgNWYg
Y2YgNWMgDQo2YiBkYyA3MCA2MCBhYyA0MiBjNiAzNSBmOCA1YSBlOCBhNCBmNyA5OCAwMSAwMSAN
CmExIGIyIGIwIDQzIDdkIGYzIGMyIDQ5IGE5IDZjIDg5IDUzIDc3IGNiIDg0IGVjIA0KYjcgZWEg
MjQgNTUgMWMgMDAgYzUgMjMgMTAgMzAgYTcgNjUgNWUgOTIgOGYgZjcgDQpiNiBjYSA5ZSA4NiA3
MCAxNyBmYiAxMyA5NyA2NyBiYiBhZCAxNyBmOSA5MyBlMCANCjMyIDc1IGE1IGJlIGQ1IDMyIDBm
IGQwIDYxIGNkIDVjIDY3IGQwIDM5IGE0IDk5IA0KZDMgNjEgZGYgMGYgNmMgYzkgMDcgZDkgZTIg
YTEgNDQgOTYgNGUgY2IgOGYgMTkgDQo3MSBjZCA2NCBmNSBlOCA2MiAzYiA5NCA0YSAxNCAzOCAx
YiAyOSAxZCA1MiBmYiANCjAwIDZjIGM2IDk1IDFlIDJlIDI2IDY3IDA0IGQwIDc2IDQxIDA5IGRl
IDU1IGQ2IA0KNTQgMTYgOWQgMDYgNTIgYzggMzAgODYgNTYgMTYgZTggZGUgNDkgN2QgNWEgMmQg
DQo5OSA2NyA0MCAwNiA3MSBlZiBlYyAxNyA0NCA5ZSBhOCBlNyAzYSAzYiBkZSA3OCANCjhlIDY2
IGU4IDQ3IGI4IGY4IDZmIDUyIDM0IDQzIGQ5IDIzIDM3IGEyIDQxIDJkIA0KNTkgOTUgOTcgMDAg
NTQgNGEgZGYgMTYgNmYgMGEgNTAgYzEgMDEgZDQgNjggNDYgDQowNSBjYSAyZiA2NyBlOCAxNCA2
NyBhYiA0ZiBjYSA3YSA3OCAwYSAyYyAwMyBjNCANCmNlIDk0IDFhIGJjIGQ3IDE5IGJhIDczIDA4
IGUxIDVmIGU1IGEyIGI1IGQxIGI4IA0KN2EgNzEgMDQgYjQgYmMgZTIgMTIgYmMgOGIgNmEgNTIg
YTQgYjIgZDYgN2YgNWUgDQo4YiA1ZSA3NSBhYyA4MiBmMiAzNCAxYSAwMSA3YSBmZiA0NyAxMSBk
YiAwMiAyZCANCjUyIGQ5IDhiIGY5IDYwIDU2IGU3IDQ5IDRiIGQyIDlhIDMzIGVmIGFlIGVjIDdm
IA0KNWMgY2QgZTEgNzIgMjMgZWUgZWIgOTggNDEgOGQgZDIgM2EgZDIgNzggMTEgMWMgDQo2ZSAy
ZSA5MCAxOCA0NCA4ZCBjYiAyMSAzOSA1NSAxZSAxZSA0ZSBjNiA4MyAxZiANCjc5IGFjIGZlIDgx
IDZkIDEzIDM1IDcyIGU4IDM2IDc2IDVkIDczIDdlIGEwIDQxIA0KMjcgYmEgODAgYmIgNGUgNjQg
MWMgNDYgYzAgYzAgOTIgN2QgNjEgMzIgYjggMDMg",
  [Parameter(Mandatory=$false)]
  [string]$jsonMode = $true				#JSON mode removes additional backslashes in the base64 string 
)


Function Base64Decode($value) 
{
	if($jsonMode = $True){
		$value = $value.replace("\=","=");
	}
		
    if($value -match "(.*\s|^)(?<base64>(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?)($|'|\s.+)"){
        $result = [System.Text.Encoding]::UNICODE.GetString([System.Convert]::FromBase64String($matches.base64))
    }else{
        $result = "No base64 encoded strings found."
    }    

    
    if($result.Length -lt 4096){
        return $result
    }else{
        return $result.substring(0,4095)
    }
}


try{
    switch ($action)
    {
        "decode"  {
            Base64Decode($value)
        }  
    }

 }
 catch{
        Write-Error "SmartResponse error.  Exception details: $ErrorMessage = $_.Exception.Message"
        exit 1
}
